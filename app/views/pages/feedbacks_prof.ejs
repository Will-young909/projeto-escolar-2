<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Feedbacks</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  <link rel="stylesheet" href="/css/infos.css">
  <link rel="icon" href="/imagens/Regimath_sem fundo cor preto2.png"/>
</head>

<body>
    <header>
    <a href="/">
      <img src="/imagens/RM_bordo.png" alt="Regimath Logo" class="logo">
    </a>
    <button class="subheader__back" onclick="history.back()">
      <i class="fas fa-arrow-left"></i> Voltar
    </button>
    </header>

  <main class="page page-feedbacks">
    <h1>Feedbacks dos Alunos</h1>

    <section class="fb-resumo">
      <p class="fb-resumo__nota"><%= resumo.media %> / 5.0</p>
      <p class="fb-resumo__info"><%= resumo.total %> avaliações no total</p>
      <section class="fb-resumo__barras">
        <% for (let i = 5; i >= 1; i--) { %>
          <section class="fb-barra">
            <p><%= i %> ★</p>
            <section class="fb-barra__track">
              <section class="fb-barra__fill" style="width: <%= resumo.distribuicao[i].percent %>%;"></section>
            </section>
            <p class="fb-barra__qtd"><%= resumo.distribuicao[i].count %></p>
          </section>
        <% } %>
      </section>
    </section>

    <section class="fb-filtros">
      <label class="fb-filtro">
        <p>Ordenar por</p>
        <select>
          <option>Mais recentes</option>
          <option>Melhores notas</option>
          <option>Piores notas</option>
        </select>
      </label>

      <label class="fb-filtro">
        <p>Filtrar por nota</p>
        <select>
          <option>Todas</option>
          <option>5 estrelas</option>
          <option>4 estrelas</option>
          <option>3 estrelas ou menos</option>
        </select>
      </label>
    </section>

    <section class="fb-lista">
      <% if (feedbacks && feedbacks.length > 0) { %>
        <% feedbacks.forEach(fb => { %>
          <article class="fb-card">
            <header class="fb-card__topo">
              <section>
                <strong><%= fb.usuario %></strong>
                <!-- <p class="fb-card__aula">Aula: Álgebra Linear</p> -->
              </section>
              <% if (fb.nota) { %>
                <section class="fb-card__nota">
                  <p><%= fb.nota.toFixed(1) %></p>
                  <p><%= '★ '.repeat(fb.nota) + '☆ '.repeat(5 - fb.nota) %></p>
                </section>
              <% } %>
            </header>
            <p class="fb-card__texto">
              <%= fb.texto %>
            </p>
            <footer class="fb-card__rodape">
              <p><%= new Date(fb.data).toLocaleDateString('pt-BR') %></p>
              <button class="fb-card__responder">Responder</button>
            </footer>
          </article>
        <% }); %>
      <% } else { %>
        <p class="lista-vazia">Ainda não há feedbacks para exibir.</p>
      <% } %>
    </section>
</main>

</body>
